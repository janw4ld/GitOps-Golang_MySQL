# Default values for go-serve.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# db and backend common env is better configured with subchart value templating
# but it's not supported by helm (yet)
# https://github.com/helm/helm/pull/6876#pullrequestreview-482774751
dbSecretName: &dbSecretName db-secret
dbUser: &dbUser go-serve
dbPort: &dbPort 34728
dbPrimaryPVC: &dbPrimaryPVC db-primary-pvc
dbSecondaryPVC: &dbSecondaryPVC db-secondary-pvc

sealed:
  # sealed values inserted here must be either created for 'default' namespace or
  # with cluster-wide scope. Otherwise, the cluster will fail to decrypt them.
  MYSQL_PASS:
  MYSQL_ROOT_PASSWORD:
  MYSQL_REPLICATION_PASSWORD:

image:
  repository: janw4ld/go-serve
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: ""

mysql:
  nameOverride: db
  architecture: replication
  auth:
    database: internship # hardcoded here since it's hardcoded in the server's code
    username: *dbUser
    existingSecret: *dbSecretName
  primary:
    service:
      ports:
        mysql: *dbPort
    persistence:
      existingClaim: *dbPrimaryPVC
  secondary:
    replicaCount: 2
    persistence:
      existingClaim: *dbSecondaryPVC
  volumePermissions:
    enabled: true

service:
  port: 9090
  initialLivenessDelay: 35
  initialReadinessDelay: 5

ingress:
  enabled: true
  className: haproxy
  annotations:
    kubernetes.io/ingress.class: haproxy
  hosts:
    - host: go-serve.local
      paths:
        - path: /api
          pathType: Exact
  tls: []
  #  - secretName: chart-example-tls
  #    hosts:
  #      - chart-example.local

resources:
  limits:
    cpu: 500m
    memory: 1Gi
  requests:
    cpu: 500m
    memory: 1Gi

autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 4
  targetCPUUtilizationPercentage: 80
  # targetMemoryUtilizationPercentage: 80

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

podAnnotations: {}

podSecurityContext:
  {}
  # fsGroup: 2000

securityContext:
  {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

nodeSelector: {}

tolerations: []

affinity: {}
